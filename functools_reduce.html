<!DOCTYPE html>
<html lang="en-US">
    <head>
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="author" content="Sam Zuckerman" />
        <meta name="copyright" content="Sam Zuckerman" />

<meta name="keywords" content="python, functools, functions, code snippet, Python, " />
        <title>What's this in functools? reduce  · programming notes
</title>
        <link href="http://cdn-images.mailchimp.com/embedcode/slim-081711.css" rel="stylesheet" type="text/css">
        <link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="https://szuckerman.github.io/theme/css/style.css" media="screen">
        <link rel="stylesheet" type="text/css" href="https://szuckerman.github.io/theme/css/solarizedlight.css" media="screen">
        <link rel="shortcut icon" href="https://szuckerman.github.io/theme/images/favicon.ico" type="image/x-icon" />
        <link rel="apple-touch-icon" href="https://szuckerman.github.io/theme/images/apple-touch-icon.png" />
        <link rel="apple-touch-icon" sizes="57x57" href="https://szuckerman.github.io/theme/images/apple-touch-icon-57x57.png" />
        <link rel="apple-touch-icon" sizes="72x72" href="https://szuckerman.github.io/theme/images/apple-touch-icon-72x72.png" />
        <link rel="apple-touch-icon" sizes="114x114" href="https://szuckerman.github.io/theme/images/apple-touch-icon-114x114.png" />
        <link rel="apple-touch-icon" sizes="144x144" href="https://szuckerman.github.io/theme/images/apple-touch-icon-144x144.png" />
        <link rel="icon" href="https://szuckerman.github.io/theme/images/apple-touch-icon-144x144.png" />
        <link href="https://szuckerman.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="programming notes - Full Atom Feed" />
        <link href="https://szuckerman.github.io/feeds/Postgres.atom.xml" type="application/atom+xml" rel="alternate" title="programming notes - Postgres Category Atom Feed" />
        <link href="https://szuckerman.github.io/feeds/Python.atom.xml" type="application/atom+xml" rel="alternate" title="programming notes - Python Category Atom Feed" />
        <link href="https://szuckerman.github.io/feeds/R.atom.xml" type="application/atom+xml" rel="alternate" title="programming notes - R Category Atom Feed" />
        <link href="https://szuckerman.github.io/feeds/Redshift.atom.xml" type="application/atom+xml" rel="alternate" title="programming notes - Redshift Category Atom Feed" />
        <link href="https://szuckerman.github.io/feeds/S3.atom.xml" type="application/atom+xml" rel="alternate" title="programming notes - S3 Category Atom Feed" />
        <link href="https://szuckerman.github.io/feeds/SQL.atom.xml" type="application/atom+xml" rel="alternate" title="programming notes - SQL Category Atom Feed" />
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-128575468-1']);
    _gaq.push(['_trackPageview']);
    (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
    </head>
    <body>
        <div id="content-sans-footer">
        <div class="navbar navbar-static-top">
            <div class="navbar-inner">
                <div class="container">
                    <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </a>
                    <a class="brand" href="https://szuckerman.github.io/"><span class=site-name>programming notes</span></a>
                    <div class="nav-collapse collapse">
                        <ul class="nav pull-right top-menu">
                            <!--<li ><a href="https://szuckerman.github.io">Home</a></li>-->
                            <li ><a href="https://szuckerman.github.io/categories.html">Categories</a></li>
                            <li ><a href="https://szuckerman.github.io/tags.html">Tags</a></li>
                            <li ><a href="https://szuckerman.github.io/archives.html">Archives</a></li>
                            <li><form class="navbar-search" action="https://szuckerman.github.io/search.html" onsubmit="return validateForm(this.elements['q'].value);"> <input type="text" class="search-query" placeholder="Search" name="q" id="tipue_search_input"></form></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="container-fluid">
            <div class="row-fluid">
                <div class="span1"></div>
                <div class="span10">
<article>
<div class="row-fluid">
    <header class="page_header span10 offset2">
    <h1><a href="https://szuckerman.github.io/functools_reduce.html"> What's this in functools? reduce  </a></h1>
    </header>
</div>

<div class="row-fluid">
        <div class="span8 offset2 article-content">

            <h1>Why do I need reduce?</h1>
<p>Honestly, you don't really. <code>reduce</code> was a built-in in Python 2 and was demoted to <code>functools</code> in Python 3. </p>
<p>Most of the examples from <code>reduce</code> can be done in an easier fashion using other built-ins.</p>
<h1>What does reduce do?</h1>
<p><code>reduce</code> works the same way as most "reduce" functions in Computer Science. It "reduces" an array of numbers to one number, adding the first number to the second, and adding subsequent numbers to each intermittent total.</p>
<h1>Example 1: Implementing a "sum" function using reduce</h1>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="kn">import</span> <span class="nn">operator</span> <span class="kn">as</span> <span class="nn">o</span>

<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="nb">reduce</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">add</span><span class="p">,</span> <span class="n">my_list</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="mi">15</span>
</pre></div>


<p>The above example works the same way as running <code>sum(my_list)</code>. </p>
<p>What the above example is doing:</p>
<ol>
<li><code>o.add</code> is a functional approach to algebra; <code>o.add(1,2)</code> is the same as <code>1 + 2</code>.</li>
<li><code>o.add</code> takes two arguments, <code>reduce</code> adds the next value to the current subtotal.</li>
</ol>
<p>It works the same way as:</p>
<div class="highlight"><pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">next_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="k">for</span> <span class="n">next_number</span> <span class="ow">in</span> <span class="n">next_numbers</span><span class="p">:</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">+</span> <span class="n">next_number</span>
</pre></div>


<p>Basically, there's always a function with two parameters used, with one of the parameters being the next value and the other being the intermediate total value.</p>
<h1>Example 2: Implementing a "factorial" function using reduce</h1>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="kn">import</span> <span class="nn">operator</span> <span class="kn">as</span> <span class="nn">o</span>

<span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>

<span class="nb">reduce</span><span class="p">(</span><span class="n">o</span><span class="o">.</span><span class="n">mul</span><span class="p">,</span> <span class="n">my_list</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="mi">120</span>
</pre></div>


<p>As you can see, it's similar to the loop we mentioned before, except that the addition operator is replaced with a multiplication operator:</p>
<div class="highlight"><pre><span></span><span class="n">total</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">next_numbers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>

<span class="k">for</span> <span class="n">next_number</span> <span class="ow">in</span> <span class="n">next_numbers</span><span class="p">:</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">*</span> <span class="n">next_number</span>
</pre></div>


<h1>Which is faster? reduce or the loops?</h1>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">timeit</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="nb">reduce</span>
<span class="kn">import</span> <span class="nn">operator</span> <span class="kn">as</span> <span class="nn">o</span>

<span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">next_numbers</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">for</span> <span class="n">next_number</span> <span class="ow">in</span> <span class="n">next_numbers</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">*</span> <span class="n">next_number</span>

    <span class="k">return</span> <span class="n">total</span>


<span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;factorial([1,2,3,4,5])&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="s2">&quot;from __main__ import factorial&quot;</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mf">0.0005066430021543056</span>

<span class="n">timeit</span><span class="o">.</span><span class="n">timeit</span><span class="p">(</span><span class="s1">&#39;reduce(o.mul, [1,2,3,4,5])&#39;</span><span class="p">,</span> <span class="n">setup</span><span class="o">=</span><span class="s2">&quot;from functools import reduce</span><span class="se">\n</span><span class="s2">import operator as o&quot;</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mf">0.000527281008544378</span>
</pre></div>


<p>From the above, it appears that our own <code>factorial</code> implementation has similar performance to using <code>reduce</code>.</p>
<h1>Conclusion</h1>
<p>There are many situations where it's useful to <code>reduce</code> numbers to a single value, however the implementation for those situations might be better suited for other functions than <code>reduce</code> from `functools.</p>
<p>Understanding how <code>reduce</code> works, by using an intermittent sum, is useful since this topic comes up often in Computer Science, and is actually how Apache Spark aggregates data. </p>
<p>As we saw above, the time difference for a user defined function or a similar version with <code>reduce</code> yield similar results. In this case one should obviously opt for whatever appears to be more clean/verbose/understandable code.  </p>
<section>
<div class="accordion" id="accordion2">
    <div class="accordion-group">
        <div class="accordion-heading">
            <a class="accordion-toggle disqus-comment-count" data-toggle="collapse" data-parent="#accordion2"
                href="https://szuckerman.github.io/functools_reduce.html#disqus_thread">
                Comments
            </a>
        </div>
        <div id="disqus_thread" class="accordion-body collapse">
            <div class="accordion-inner">
                <div class="comments">
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'szuckerman-github-io-1';
        var disqus_identifier = 'https://szuckerman.github.io/functools_reduce.html';
    var disqus_url = 'https://szuckerman.github.io/functools_reduce.html';

    (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
     })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>                </div>
            </div>
        </div>
    </div>
</div>
</section>
            <aside>
            <hr/>
            <nav>
            <ul class="articles_timeline">
 
                <li class="previous_article">« <a href="https://szuckerman.github.io/getting-tripped-up-with-median-in-redshift-and-postgresql.html" title="Previous: Getting tripped up with "MEDIAN" in Redshift and PostgreSQL">Getting tripped up with "MEDIAN" in Redshift and PostgreSQL</a></li>
 
                <li class="next_article"><a href="https://szuckerman.github.io/integer_division_in_redshift.html" title="Next: Integer Division in Redshift: Gotcha!">Integer Division in Redshift: Gotcha!</a> »</li>
            </ul>
            </nav>
            </aside>
        </div>
        <section>
        <div class="span2" style="float:right;font-size:0.9em;">
 
            <h4>Published</h4>
            <time pubdate="pubdate" datetime="2019-01-11T15:30:00-05:00">Jan 11, 2019</time>
 
            <h4>Last Updated</h4>
            <div class="last_updated">2019-01-11 15:30:00-05:00</div>
            <h4>Category</h4>
            <a class="category-link" href="/categories.html#Python-ref">Python</a> 
            <h4>Tags</h4>
            <ul class="list-of-tags tags-in-article"> 
                <li><a href="/tags.html#code-snippet-ref">code snippet
                    <span>12</span>
</a></li>
                <li><a href="/tags.html#functions-ref">functions
                    <span>8</span>
</a></li>
                <li><a href="/tags.html#functools-ref">functools
                    <span>7</span>
</a></li>
                <li><a href="/tags.html#python-ref">python
                    <span>16</span>
</a></li>
            </ul>

        </div>
        </section>
</div>
</article>
                </div>
                <div class="span1"></div>
            </div>
        </div>
    </div>
<footer>
<div id="footer">
    <ul class="footer-content">
        <li class="elegant-power">Powered by <a href="http://getpelican.com/" title="Pelican Home Page">Pelican</a>. Theme: <a href="http://oncrashreboot.com/pelican-elegant" title="Theme Elegant Home Page">Elegant</a> by <a href="http://oncrashreboot.com" title="Talha Mansoor Home Page">Talha Mansoor</a></li>
    </ul>
</div>
</footer>            <script src="http://code.jquery.com/jquery.min.js"></script>
        <script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>
        <script>
            function validateForm(query)
            {
                return (query.length > 0);
            }
        </script>

<script type="text/javascript">
    var disqus_shortname = 'szuckerman-github-io-1';

    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
    </script>
        <script  language="javascript" type="text/javascript">
            function uncollapse() {
                var hash_str = window.location.hash;
                if (window.location.hash.match(/^#comment-\d+$/))
                {
                    var hash_str = '#disqus_thread';
                }
                $(hash_str).collapse({
                    toggle: true
                    })
            }
        </script>

        <script type="text/javascript" language="JavaScript">
            uncollapse(); 
        </script>
    </body>
</html>